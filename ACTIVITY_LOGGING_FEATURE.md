# Activity Logging Feature

‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° activities ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏û‡∏£‡πâ‡∏≠‡∏° Admin Dashboard ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå

## ‚ú® Features

### 1. Activity Logging
‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å activities ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:
- **Upload** - ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
- **Transcribe** - ‡πÅ‡∏Å‡∏∞‡πÄ‡∏™‡∏µ‡∏¢‡∏á
- **Translate** - ‡πÅ‡∏õ‡∏•‡∏ã‡∏±‡∏ö‡πÑ‡∏ï‡πÄ‡∏ï‡∏¥‡πâ‡∏•
- **Embed Subtitle** - ‡∏ù‡∏±‡∏á‡∏ã‡∏±‡∏ö‡πÑ‡∏ï‡πÄ‡∏ï‡∏¥‡πâ‡∏•

### 2. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
- Session ID / Username
- Activity Type
- File ID
- Details (JSON):
  - Provider (openai/botnoi)
  - Target Language
  - Style Prompt
  - Subtitle Type (hard/soft)
  - Font Settings
  - File Size, Duration
- Status (success/failed)
- Error Message (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
- Timestamp

### 3. Admin Dashboard - Activity Logs Tab

#### Filters:
- **Activity Type** - ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó activity
- **Username** - ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏° user
- **Status** - Success/Failed
- **Date Range** - ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤

#### Features:
- **Pagination** - 30 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤
- **Detail Modal** - ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏ï‡πá‡∏°
- **Color-coded Badges**:
  - üîµ Upload (Blue)
  - üü¢ Transcribe (Green)
  - üü° Translate (Yellow)
  - üü£ Embed (Purple)
- **Real-time Search** - ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏≤‡∏Å username, file_id

### 4. Activity Statistics
‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ System Stats:
- **Total Activities** - ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô activities ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- **Activities by Type** - ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
- **Provider Usage** - OpenAI vs Botnoi
- **Success Rate** - ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
- **Language Usage** - ‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
- **Recent Trends** - ‡∏Å‡∏£‡∏≤‡∏ü 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î

## üìä Database Schema

### Table: `activity_logs`
```sql
CREATE TABLE activity_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    session_id TEXT NOT NULL,
    username TEXT,
    activity_type TEXT NOT NULL,
    file_id TEXT,
    details TEXT,  -- JSON
    status TEXT NOT NULL DEFAULT 'success',
    error_message TEXT,
    created_at TEXT NOT NULL
)
```

### Indexes:
- `idx_activity_session` - session_id
- `idx_activity_type` - activity_type
- `idx_activity_created` - created_at

## üîå API Endpoints

### GET /admin/activities
‡∏î‡∏∂‡∏á activity logs ‡∏û‡∏£‡πâ‡∏≠‡∏° filters

**Query Parameters:**
- `limit` (default: 50)
- `offset` (default: 0)
- `activity_type` (optional)
- `session_id` (optional)
- `username` (optional)
- `status` (optional)
- `date_from` (optional)
- `date_to` (optional)

**Response:**
```json
{
  "total": 150,
  "activities": [...],
  "limit": 50,
  "offset": 0
}
```

### GET /admin/activities/stats
‡∏î‡∏∂‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ activities

**Response:**
```json
{
  "total_activities": 150,
  "by_type": {
    "upload": 50,
    "transcribe": 40,
    "translate": 35,
    "embed_subtitle": 25
  },
  "by_status": {
    "success": 145,
    "failed": 5
  },
  "provider_usage": {
    "openai": 60,
    "botnoi": 15
  },
  "language_usage": {
    "en": 20,
    "th": 10,
    "jp": 5
  },
  "recent_by_date": [...]
}
```

## üíª Frontend Components

### 1. ActivityLogs.jsx
- Activity logs table with filters
- Pagination
- Detail modal
- Color-coded badges

### 2. SystemStats.jsx (Updated)
- ‡πÄ‡∏û‡∏¥‡πà‡∏° Activity Statistics section
- ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥

### 3. AdminDashboard.jsx (Updated)
- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ó‡πá‡∏ö "Activity Logs"

## üéØ Use Cases

### 1. Monitoring
- ‡∏î‡∏π‡∏ß‡πà‡∏≤ user ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á
- ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô provider (OpenAI vs Botnoi)
- ‡πÄ‡∏ä‡πá‡∏Ñ‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

### 2. Debugging
- ‡∏î‡∏π error logs
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö failed activities
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤

### 3. Analytics
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
- ‡∏î‡∏π trends
- ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô capacity

### 4. Auditing
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á user
- ‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
- Compliance tracking

## üöÄ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### Admin Dashboard:
1. Login ‡πÄ‡∏õ‡πá‡∏ô admin
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö "Activity Logs"
3. ‡πÉ‡∏ä‡πâ filters ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
4. ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô üëÅÔ∏è ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

### System Stats:
1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö "‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏∞‡∏ö‡∏ö"
2. ‡∏î‡∏π "Activity Statistics" section
3. ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

## üìù ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Activity Details

### Upload:
```json
{
  "file_size_mb": 45.2,
  "duration_seconds": 145.3,
  "original_filename": "video.mp4"
}
```

### Transcribe:
```json
{
  "provider": "openai",
  "segments_count": 42
}
```

### Translate:
```json
{
  "provider": "botnoi",
  "target_language": "en",
  "style_prompt": "‡πÅ‡∏õ‡∏•‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£",
  "segments_count": 42
}
```

### Embed Subtitle:
```json
{
  "subtitle_type": "hard",
  "language": "th",
  "speed_preset": "balanced",
  "font_settings": {
    "font_name": "TH Sarabun New",
    "font_size": 20,
    "bold": true
  }
}
```

## üîß Technical Details

### Backend:
- `database.py` - ‡πÄ‡∏û‡∏¥‡πà‡∏° `log_activity()`, `get_activities()`, `get_activity_stats()`
- `main.py` - ‡πÄ‡∏û‡∏¥‡πà‡∏° logging ‡πÉ‡∏ô endpoints ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- Automatic logging on success/failure

### Frontend:
- `ActivityLogs.jsx` - Main component
- `SystemStats.jsx` - Activity stats display
- `adminApi.js` - API functions

### Performance:
- Indexed queries ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö fast filtering
- Pagination ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î data load
- Efficient JSON parsing

## üé® UI/UX Highlights

- **Color-coded badges** - ‡πÅ‡∏¢‡∏Å‡πÅ‡∏¢‡∏∞ activity type ‡∏á‡πà‡∏≤‡∏¢
- **Responsive design** - ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
- **Quick filters** - ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß
- **Detail modal** - ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°
- **Clean layout** - ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡πÑ‡∏°‡πà‡∏¢‡∏∏‡πà‡∏á‡πÄ‡∏´‡∏¢‡∏¥‡∏á

## üìà Future Enhancements

- Export to CSV
- Real-time updates (WebSocket)
- Advanced charts (Chart.js)
- Activity alerts/notifications
- Log retention policy
- Archive old logs

---

**Status:** ‚úÖ Implemented and Ready to Use
**Version:** 1.0.0
**Date:** November 23, 2025
